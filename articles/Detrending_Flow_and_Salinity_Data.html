<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Flow and Salinity Data Sets • baytrends</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Flow and Salinity Data Sets">
<meta property="og:description" content="baytrends">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">baytrends</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.8.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Detrending_Flow_and_Salinity_Data.html">Flow and Salinity Data Sets</a>
    </li>
    <li>
      <a href="../articles/Processing_Censored_Data.html">Processing Censored Water Quality Data</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/tetratech/baytrends/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Detrending_Flow_and_Salinity_Data_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Flow and Salinity Data Sets</h1>
                        <h4 data-toc-skip class="author">
<a href="mailto:Jon.Harcum@tetratech.com" class="email">Jon.Harcum@tetratech.com</a> and <a href="mailto:Erik.Leppo@tetratech.com" class="email">Erik.Leppo@tetratech.com</a>
</h4>
            
            <h4 data-toc-skip class="date">2022-05-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/tetratech/baytrends/blob/HEAD/vignettes/Detrending_Flow_and_Salinity_Data.Rmd" class="external-link"><code>vignettes/Detrending_Flow_and_Salinity_Data.Rmd</code></a></small>
      <div class="hidden name"><code>Detrending_Flow_and_Salinity_Data.Rmd</code></div>

    </div>

    
    
<!-- Data is in vignettes\data folder  -->
<div class="section level2">
<h2 id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h2>
<p>The purpose of this vignette is to cover the basics for creating seasonally detrended flow and seasonally detrended salinity data sets. These data sets are used in support of applying <strong>gam4</strong>. In gam4, the dependent variable is modeled with a non-linear term as a function of year; a seasonality term includes an interaction term which allows seasonality to vary over the period of record; and includes a hydrologic term that allows for factoring wet/dry conditions in the model.</p>
<p>The seasonally detrended flow and salinity data sets are created using the detrended.flow and detrended.salinity functions included in baytrends. Refer to the help for each of these functions (e.g., ??detrended.flow or ??detrended.salinity) for the specific computational steps involved with each function.</p>
</div>
<div class="section level2">
<h2 id="load-baytrends">Load baytrends<a class="anchor" aria-label="anchor" href="#load-baytrends"></a>
</h2>
<p>The first step is to load the baytrends library. Loading baytrends will result in loading multiple additional libraries as well.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tetratech/baytrends" class="external-link">baytrends</a></span><span class="op">)</span>
<span class="co">#&gt; Loading:baytrends v2.0.8.9001</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'baytrends'</span>
<span class="co">#&gt; The following object is masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     nobs</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="seasonally-detrended-flow">Seasonally Detrended Flow<a class="anchor" aria-label="anchor" href="#seasonally-detrended-flow"></a>
</h2>
<p>The function, <strong>detrended.flow</strong>, returns a list of seasonally detrended flow and companion statistics. It relies on USGS’ dataRetrieval package to retrieve daily flow data.</p>
<p><strong>It is the user’s responsibility to save the list that is returned from the detrended.flow function as flow.detrended for integration with baytrends.</strong></p>
<p>For purposes of the Chesapeake Bay Program, it is expected that the user would typically identify all nine of the <em>River Input Monitoring</em> (RIM) stations. The nine RIM stations for the Chesapeake Bay have been loaded as a data frame in baytrends, <strong>usgsGages</strong>.</p>
<p><em>Table 1. Chesapeake Bay River Input Monitoring Stations</em></p>
<table class="table">
<thead><tr class="header">
<th align="left">usgsGageID</th>
<th align="left">siteName</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">01491000</td>
<td align="left">Choptank River near Greensboro, MD</td>
</tr>
<tr class="even">
<td align="left">01578310</td>
<td align="left">Susquehanna River at Conowingo, MD</td>
</tr>
<tr class="odd">
<td align="left">01594440</td>
<td align="left">Patuxent River near Bowie, MD</td>
</tr>
<tr class="even">
<td align="left">01646500</td>
<td align="left">Potomac River at Chain Bridge, Washington, DC</td>
</tr>
<tr class="odd">
<td align="left">01668000</td>
<td align="left">Rappahannock River near Fredericksburg, VA</td>
</tr>
<tr class="even">
<td align="left">01673000</td>
<td align="left">Pamunkey River near Hanover, VA</td>
</tr>
<tr class="odd">
<td align="left">01674500</td>
<td align="left">Mattaponi River near Beulahville, VA</td>
</tr>
<tr class="even">
<td align="left">02035000</td>
<td align="left">James River at Cartersville, VA</td>
</tr>
<tr class="odd">
<td align="left">02041650</td>
<td align="left">Appomattox River at Matoaca, VA</td>
</tr>
</tbody>
</table>
<p>The below code chunk is an example of retrieving and seasonally detrending daily flow data for all nine of the RIM stations from 1983-2017. To retrieve data for other USGS gages, the variables, usgsGagesID and siteName would be assigned with vectors that contain the list of USGS gage IDs and their site names. The vector of gage IDs are used to retrieve data while the vector of siteNames is used for diagnostic plots created by the function, detrend.flow.</p>
<p>To best match up with water quality data, we recommend retrieving flow data for one year prior to the first year of water quality data. This allows for creating a time-averaged flow data set and not loose the first few months of water quality data due to lack of matching flow data. Data retrievals should also be made in light of the time needed by the USGS to review and approve their flow records.</p>
<p>Information about the settings for dvAvgWinSel, dvAvgWgtSel, dvAvgSidesSel, lowess.f, span, and max.fill are described in the help file for this function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tetratech/baytrends" class="external-link">baytrends</a></span><span class="op">)</span>
<span class="co"># Define Function Inputs</span>
<span class="va">usgsGageID</span>    <span class="op">&lt;-</span> <span class="va">usgsGages</span><span class="op">$</span><span class="va">usgsGageID</span> <span class="co"># all RIM stations</span>
<span class="va">siteName</span>      <span class="op">&lt;-</span> <span class="va">usgsGages</span><span class="op">$</span><span class="va">siteName</span>   <span class="co"># all RIM stations</span>
<span class="va">yearStart</span>     <span class="op">&lt;-</span> <span class="fl">1983</span>
<span class="va">yearEnd</span>       <span class="op">&lt;-</span> <span class="fl">2017</span>
<span class="va">dvAvgWinSel</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">50</span>, <span class="fl">60</span>, <span class="fl">90</span>, <span class="fl">120</span>, <span class="fl">150</span>, <span class="fl">180</span>, <span class="fl">210</span><span class="op">)</span>
<span class="va">dvAvgWgtSel</span>   <span class="op">&lt;-</span> <span class="st">"uniform"</span>
<span class="va">dvAvgSidesSel</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">lowess.f</span>      <span class="op">&lt;-</span> <span class="fl">0.2</span>

<span class="co"># Run detrended.flow function</span>
<span class="va">flow.detrended</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/detrended.flow.html">detrended.flow</a></span><span class="op">(</span><span class="va">usgsGageID</span>, <span class="va">siteName</span>, <span class="va">yearStart</span>, <span class="va">yearEnd</span>
                                 , <span class="va">dvAvgWinSel</span>, <span class="va">dvAvgWgtSel</span>, <span class="va">dvAvgSidesSel</span>
                                 , <span class="va">lowess.f</span><span class="op">)</span>

<span class="co"># Save list to data file separate use</span>
<span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">flow.detrended</span>, file<span class="op">=</span><span class="st">'mySeasonallyDetrendedFlow.rda'</span><span class="op">)</span></code></pre></div>
<div class="section level3">
<h3 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h3>
<p>The following five figures Figures 1-5 provide an example analysis for the USGS gage on the Susquehanna River at Conowingo, Maryland. Figure 1 displays the daily flow values [cms] as a function of the day of year for data from 2003-2017. The solid red line represents the predicted GAM using the function Log(Q)~s(doy,bs=‘cc’).</p>
<p>Subtracting the predicted GAM from the observations yields the observations plotted in Figure 2. The ordinate is plotted on a log scale since the predicted GAM and observations were log transformed. We also refer to this as the 1-day-smoothed residuals. A 10-day-smoothed residual is displayed in Figure 3. Using the above settings for dvAvgWgtSel (“uniform”) and dvAvgSidesSel (1), the 10-day smoothed residual is the average of the preceeding nine days and the current day of the 1-day-smoothed residual. That is, the value on June 10, 2015 is equal to the average of the values from June 1-10, 2015. As the number of days used in the averaging process increases, the range of residuals decreases. These x-day smoothed residuals are used in gam4 and can be thought of an indicator of how wet or dry a particular time period is relative to the average.</p>
<p>Figures 4 and 5 display summary statistics (mean, standard deviation [sd], and number of observations [Nobs.] for the 1-day and 10-day smoothed residuals. The red line on the standard deviation plot is based on a lowess smooth. The standard deviations associated with the red line are used for computing confidence intervals.</p>
</div>
</div>
<div class="section level2">
<h2 id="susquehanna-river-at-conowingo-md">01578310-Susquehanna River at Conowingo, MD<a class="anchor" aria-label="anchor" href="#susquehanna-river-at-conowingo-md"></a>
</h2>
<p><img src="Detrending_Flow_and_Salinity_Data_files/figure-html/flow1-1.png" width="624"></p>
<p><em>Figure 1. Daily Flow [cms] as a Function of Day of Year. (Solid red line is the predicted GAM model using the model: gam(LogQ ~ s(doy,bs=‘cc’)).)</em></p>
<p><img src="Detrending_Flow_and_Salinity_Data_files/figure-html/flow1-2.png" width="624"></p>
<p><em>Figure 2. 1-day-smoothed Seasonally-adjusted Log Flow Residuals as a Function of Day of Year.</em></p>
<p><img src="Detrending_Flow_and_Salinity_Data_files/figure-html/flow1-3.png" width="624"></p>
<p><em>Figure 3. 10-day-smoothed Seasonally-adjusted Log Flow Residuals as a Function of Day of Year.</em></p>
</div>
<div class="section level2">
<h2 id="susquehanna-river-at-conowingo-md-avg--per--d1">01578310-Susquehanna River at Conowingo, MD (Avg. Per.: d1)<a class="anchor" aria-label="anchor" href="#susquehanna-river-at-conowingo-md-avg--per--d1"></a>
</h2>
<p><img src="Detrending_Flow_and_Salinity_Data_files/figure-html/flow1-4.png" width="624"></p>
<p><em>Figure: d1: Mean, standard deviation, and number of observations as a Function of Day of Year.</em></p>
</div>
<div class="section level2">
<h2 id="susquehanna-river-at-conowingo-md-avg--per--d10">01578310-Susquehanna River at Conowingo, MD (Avg. Per.: d10)<a class="anchor" aria-label="anchor" href="#susquehanna-river-at-conowingo-md-avg--per--d10"></a>
</h2>
<p><img src="Detrending_Flow_and_Salinity_Data_files/figure-html/flow1-5.png" width="624"></p>
<p><em>Figure: d10: Mean, standard deviation, and number of observations as a Function of Day of Year.</em></p>
</div>
<div class="section level2">
<h2 id="seasonally-detrended-salinity">Seasonally Detrended Salinity<a class="anchor" aria-label="anchor" href="#seasonally-detrended-salinity"></a>
</h2>
<p>The function, <strong>detrended.salinity</strong>, returns a list of seasonally detrended salinity and companion statistics.</p>
<p><strong>It is the user’s responsibility to save the list that is returned from the detrended.salinity function as salinity.detrended for integration with baytrends.</strong></p>
<p>The detrended.salinity evaluates a user-supplied data set. baytrends includes a sample salinity data set, <strong>sal</strong>, that corresponds to the water quality data stored in <strong>dataCensored</strong>. Table 2 and Table 3 display some sample data and the structure of <strong>sal</strong>.</p>
<p><em>Table 2. Example Salinity Data</em></p>
<table class="table">
<thead><tr class="header">
<th align="left">station</th>
<th align="left">date</th>
<th align="left">layer</th>
<th align="right">salinity</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">LE3.6</td>
<td align="left">1984-06-27 04:00:00</td>
<td align="left">S</td>
<td align="right">11.71</td>
</tr>
<tr class="even">
<td align="left">LE3.6</td>
<td align="left">1984-06-27 04:00:00</td>
<td align="left">B</td>
<td align="right">13.44</td>
</tr>
<tr class="odd">
<td align="left">CB5.4</td>
<td align="left">1984-06-29 04:00:00</td>
<td align="left">S</td>
<td align="right">10.17</td>
</tr>
<tr class="even">
<td align="left">CB5.4</td>
<td align="left">1984-06-29 04:00:00</td>
<td align="left">B</td>
<td align="right">21.07</td>
</tr>
<tr class="odd">
<td align="left">CB5.1</td>
<td align="left">1984-07-10 04:00:00</td>
<td align="left">S</td>
<td align="right">8.69</td>
</tr>
<tr class="even">
<td align="left">LE3.6</td>
<td align="left">1984-07-11 04:00:00</td>
<td align="left">S</td>
<td align="right">12.90</td>
</tr>
</tbody>
</table>
<p><em>Table 3. Data Structure Associated with sal</em></p>
<pre><code><span class="co">#&gt; 'data.frame':    51092 obs. of  4 variables:</span>
<span class="co">#&gt;  $ station : chr  "LE3.6" "LE3.6" "LE3.6" "LE3.6" ...</span>
<span class="co">#&gt;  $ date    : POSIXct, format: "1984-06-27 04:00:00" "1984-06-27 04:00:00" ...</span>
<span class="co">#&gt;  $ layer   : chr  "S" "M" "M" "B" ...</span>
<span class="co">#&gt;  $ salinity: num  11.7 12.1 12.6 13.4 21.6 ...</span></code></pre>
<p>The below code chunk is an example for analyzing all of the data contained in the sample data frame, sal. As currently developed, detrended.salinity will average salinity in the surface (‘S’) and above pycnocline (‘AP’) layers to create an average salinity value for the surface and above pycnocline (SAP) layer. detrended.salinity will also average salinity in the bottom (‘B’) and below pycnocline (‘AP’) layers to create an average salinity value for the bottom and below pycnocline (BAP) layer.</p>
<p>The use and settings for dvAvgWinSel, lowess.f, minObs, and minObs.sd are described in the help file. The detrened.salinity function will assume the user wants to evaluate the salinity for all of the stations in sal and for all the years of available data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># Define Function Inputs</span>
<span class="va">df.sal</span>      <span class="op">&lt;-</span> <span class="va">sal</span>
<span class="va">dvAvgWinSel</span> <span class="op">&lt;-</span> <span class="fl">30</span>
<span class="va">lowess.f</span>    <span class="op">&lt;-</span> <span class="fl">0.2</span>
<span class="va">minObs</span>      <span class="op">&lt;-</span> <span class="fl">40</span>
<span class="va">minObs.sd</span>   <span class="op">&lt;-</span> <span class="fl">10</span>
                 
<span class="co"># Run Function</span>
<span class="va">salinity.detrended</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/detrended.salinity.html">detrended.salinity</a></span><span class="op">(</span><span class="va">df.sal</span>, <span class="va">dvAvgWinSel</span>, 
                                 <span class="va">lowess.f</span>, <span class="va">minObs</span>, <span class="va">minObs.sd</span><span class="op">)</span>   

<span class="co"># Save list to data file separate use</span>
<span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">salinity.detrended</span>, file<span class="op">=</span><span class="st">'mySeasonallyDetrendedSalinity.rda'</span><span class="op">)</span></code></pre></div>
<div class="section level3">
<h3 id="example-1">Example<a class="anchor" aria-label="anchor" href="#example-1"></a>
</h3>
<p>The below figures display summary statistics (mean, standard deviation [sd], and number of observations [Nobs.] for the SAP and BBP layers, respectively. The red line on the standard deviation plot is based on a lowess smooth. The standard deviations associated with the red line are used for computing confidence intervals.</p>
<p>The reader is referred to the help file for detrend.salinity to learn more about the procedure used to compute these statistics and how windowing is used address the issues related to sparse sampling.</p>
<p>[1] “CB5.4 (Surface: TRUE / Bottom: TRUE)” <img src="Detrending_Flow_and_Salinity_Data_files/figure-html/salinity3-1.png" width="624"></p>
<p><em>Figure 1. SAP mean, standard deviation, and number of observations as a Function of Day of Year.</em></p>
<p><img src="Detrending_Flow_and_Salinity_Data_files/figure-html/salinity3-2.png" width="624"></p>
<p><em>Figure 2. BBP mean, standard deviation, and number of observations as a Function of Day of Year.</em></p>
</div>
</div>
<div class="section level2">
<h2 id="example-gam-analysis">Example GAM Analysis<a class="anchor" aria-label="anchor" href="#example-gam-analysis"></a>
</h2>
<p>It is now possible to run gam4 using the results of the above analyses. The below code chunk will run the gam4 for surface total nitrogen at station CB5.4.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">dfr</span>       <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analysisOrganizeData.html">analysisOrganizeData</a></span><span class="op">(</span><span class="va">dataCensored</span>, reports <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>
<span class="va">df</span>        <span class="op">&lt;-</span> <span class="va">dfr</span><span class="op">[[</span><span class="st">"df"</span><span class="op">]</span><span class="op">]</span>
<span class="va">analySpec</span> <span class="op">&lt;-</span> <span class="va">dfr</span><span class="op">[[</span><span class="st">"analySpec"</span><span class="op">]</span><span class="op">]</span>

<span class="co"># down select analyzed GAM</span>
<span class="va">analySpec</span><span class="op">$</span><span class="va">gamModels</span> <span class="op">&lt;-</span> <span class="va">analySpec</span><span class="op">$</span><span class="va">gamModels</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>

<span class="va">stat</span> <span class="op">=</span> <span class="st">'CB5.4'</span>; <span class="va">dep</span> <span class="op">=</span> <span class="st">'tn'</span>; <span class="va">layer</span> <span class="op">=</span> <span class="st">'S'</span>;
<span class="va">gamResult</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gamTest.html">gamTest</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">df</span>, dep <span class="op">=</span> <span class="va">dep</span>, stat <span class="op">=</span> <span class="va">stat</span>, layer <span class="op">=</span> <span class="va">layer</span>
                     , analySpec <span class="op">=</span> <span class="va">analySpec</span>
                     , salinity.detrended <span class="op">=</span> <span class="va">salinity.detrended</span><span class="op">)</span>
<span class="co">#&gt; Warning: Detrended flow data (flow.detrended) not passed as argument in gamTest,</span>
<span class="co">#&gt; but models included in analySpec include those with 'flw_sal' term. Consider</span>
<span class="co">#&gt; passing detrended flow data or reducing models specified in analySpec.</span></code></pre></div>
<div class="section level4">
<h4 id="total-nitrogen---non-linear-trend-with-seasint--hydro-adj">Total Nitrogen - Non-linear trend with Seas+Int. &amp; Hydro Adj<a class="anchor" aria-label="anchor" href="#total-nitrogen---non-linear-trend-with-seasint--hydro-adj"></a>
</h4>
<p>Warning: mgcv convergence failed</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Erik W Leppo.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
