<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Select data for analysis from a larger data frame — selectData • baytrends</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Select data for analysis from a larger data frame — selectData" />
<meta property="og:description" content="Select data for analysis from a larger data frame based on dependent
variable, station, and layer. Removing records with missing
values, performing log-transformations, and adding a centering date are
performed based on settings." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">baytrends</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.2.9002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Detrending_Flow_and_Salinity_Data.html">Flow and Salinity Data Sets</a>
    </li>
    <li>
      <a href="../articles/Processing_Censored_Data.html">Processing Censored Water Quality Data</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/tetratech/baytrends/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Select data for analysis from a larger data frame</h1>
    <small class="dont-index">Source: <a href='https://github.com/tetratech/baytrends/blob/master/R/selectData.R'><code>R/selectData.R</code></a></small>
    <div class="hidden name"><code>selectData.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Select data for analysis from a larger data frame based on dependent
variable, station, and layer. Removing records with missing
values, performing log-transformations, and adding a centering date are
performed based on settings.</p>
    </div>

    <pre class="usage"><span class='fu'>selectData</span><span class='op'>(</span>
  <span class='va'>df</span>,
  <span class='va'>dep</span>,
  <span class='va'>stat</span>,
  layer <span class='op'>=</span> <span class='cn'>NA</span>,
  transform <span class='op'>=</span> <span class='cn'>TRUE</span>,
  remMiss <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>analySpec</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>df</th>
      <td><p>data frame</p></td>
    </tr>
    <tr>
      <th>dep</th>
      <td><p>dependent variable</p></td>
    </tr>
    <tr>
      <th>stat</th>
      <td><p>station</p></td>
    </tr>
    <tr>
      <th>layer</th>
      <td><p>layer (optional)</p></td>
    </tr>
    <tr>
      <th>transform</th>
      <td><p>logical field to return log-transformed value (TRUE [default])</p></td>
    </tr>
    <tr>
      <th>remMiss</th>
      <td><p>logical field to remove records where dependent
variable, dep, is a missing value (TRUE [default])</p></td>
    </tr>
    <tr>
      <th>analySpec</th>
      <td><p>analytical specifications</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A nest list is returned. The first element of the nest list is the down-selected
  data frame. The second element is the list, iSpec, contains specifications for
  data extraction. See examples for usage and details for further discussion of the data
  processing and components of each element.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The returned data frame will include dyear and cyear. dyear is the decimal
 year computed using smwrBase::baseDay2decimal and smwrBase::baseDay. From
 this, the minimum and maximum 'dyear' are averaged. This averaged value,
 centerYear, is used to compute the centering date, cyear, using cyear =
 dyear - centerYear.</p>
<p>The variable identified by dep is copied to the variable name dep+".orig"
 (e.g., chla.orig) allowing the user to track the original concentrations. A
 new column, recensor, is added. The value of recensor is FALSE unless the
 value of dep.orig was &lt;=0. In the cases where dep.orig is &lt;= 0, recensor is
 set to TRUE and the value of dep is set to "less-than" a small positive
 value which is stored as iSpec$recensor. If transform=TRUE, the returned
 data frame will also include a variable "ln"+dep (i.e., "lnchla" for log
 transformed chla).</p>
<p>The data frame will include a column, intervention, which is a factor identifying
 different periods of record such as when different laboratory methods were
 used and is based on the data frame methodsList that is loaded into the
 global environment. This column is set to "A" with only 1 level if the data
 frame methodsList has not been loaded into the global environment.</p>
<p>The data frame will include a column, lowCensor, to indicate whether the
 data record occurs in a year with a low level of censoring over that
 particular year. The function gamTest uses this column to identify years of
 record (i.e., when lowCensor==FALSE) that should not be used in analyses.</p>
<p>If remMiss=TRUE, then the returned data frame will be down selected by
 removing records where the variable identified in 'dep' is missing;
 otherwise, no down selection is performed.</p>
<p>iSpec contains a large list of information</p>
<p>dep - name of column where dependent variable is stored, could be "ln"+dep
for variables that will be analyzed after natural log transformation</p>
<p>depOrig - name of original dependent variable, could be same as dep if no
transformation is used</p>
<p>stat - name of station</p>
<p>stationMethodGroup - name of station group that the station belongs to,
derived from station list (stationMasterList) and used to identify interventions
specified in methodsList table</p>
<p>intervenNum - number of interventions found for this station and dependent
variable as derived from methodsList table, a value of 1 is assigned if no
methodsList entry is found</p>
<p>intervenList - data frame of interventions identified by beginning and ending
date and labeled consecutively starting with "A"</p>
<p>layer - layer</p>
<p>layerName - layer name derived from layerLukup</p>
<p>transform - TRUE/FALSE indicating whether log transformations were taken</p>
<p>trendIncrease - an indicator for interpretation of an increasing concentration</p>
<p>logConst - not currently used</p>
<p>recensor - small value that observations &lt;=0 are recensored to as "less than"
the small value</p>
<p>censorFrac - data frame indicating the yearly number of observations and
fraction of observations reported as less than, uncensored, interval
censored, less than zero, and recensored; also includes a 'lowCensor' field
indicating which years will be dropped by gamTest due to high yearly
censoring</p>
<p>yearRangeDropped - year range of data that will be dropped due to censoring</p>
<p>censorFracSum - censoring overall summary</p>
<p>centerYear - centering year</p>
<p>parmName - parameter name</p>
<p>parmNamelc - parameter name in lower case</p>
<p>parmUnits - parameter units</p>
<p>statLayer - station/layer label, e.g., "LE3.1 (S)"</p>
<p>usgsGageID - USGS gage used for flow adjustments</p>
<p>usgsGageName - USGS gage used for flow adjustments</p>
<p>numObservations - number of observations</p>
<p>dyearBegin - begin date in decimal form</p>
<p>dyearEnd - end date in decimal form</p>
<p>dyearLength - period of record length</p>
<p>yearBegin - period of record begin year</p>
<p>yearend - period of record end year</p>
<p>dateBegin - begin date</p>
<p>dateEnd - end date</p>
<p>The baseDay and baseDay2decimal functions have been added to this package 
from the smwrBase package.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>dfr</span>    <span class='op'>&lt;-</span> <span class='fu'><a href='analysisOrganizeData.html'>analysisOrganizeData</a></span><span class='op'>(</span><span class='va'>dataCensored</span><span class='op'>)</span>

<span class='co'># retrieve Secchi depth for Station CB5.4, no transformations are applied</span>
<span class='va'>dfr1</span>   <span class='op'>&lt;-</span> <span class='fu'>selectData</span><span class='op'>(</span><span class='va'>dfr</span><span class='op'>[[</span><span class='st'>"df"</span><span class='op'>]</span><span class='op'>]</span>, <span class='st'>'secchi'</span>, <span class='st'>'CB5.4'</span>, <span class='st'>'S'</span>, transform<span class='op'>=</span><span class='cn'>FALSE</span>,
                    remMiss<span class='op'>=</span><span class='cn'>FALSE</span>, analySpec<span class='op'>=</span><span class='va'>dfr</span><span class='op'>[[</span><span class='st'>"analySpec"</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>df1</span>    <span class='op'>&lt;-</span> <span class='va'>dfr1</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>   <span class='co'># data frame of selected data</span>
<span class='va'>iSpec1</span> <span class='op'>&lt;-</span> <span class='va'>dfr1</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span>   <span class='co'># meta data about selected data</span>

<span class='co'># retrieve surface corrected chlorophyll-a concentrations for Station CB5.4,</span>
<span class='co'># missing values are removed and transformation applied</span>
<span class='va'>dfr2</span>   <span class='op'>&lt;-</span> <span class='fu'>selectData</span><span class='op'>(</span><span class='va'>dfr</span><span class='op'>[[</span><span class='st'>"df"</span><span class='op'>]</span><span class='op'>]</span>, <span class='st'>'chla'</span>, <span class='st'>'CB5.4'</span>, <span class='st'>'S'</span>, analySpec<span class='op'>=</span><span class='va'>dfr</span><span class='op'>[[</span><span class='st'>"analySpec"</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>df2</span>    <span class='op'>&lt;-</span> <span class='va'>dfr2</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>   <span class='co'># data frame of selected data</span>
<span class='va'>iSpec2</span> <span class='op'>&lt;-</span> <span class='va'>dfr2</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span>   <span class='co'># meta data about selected data</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Erik W Leppo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


